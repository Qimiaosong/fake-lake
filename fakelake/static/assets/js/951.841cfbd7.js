"use strict";(self["webpackChunkdata_lake_analytics"]=self["webpackChunkdata_lake_analytics"]||[]).push([[951],{8951:function(e,a,t){t.r(a),t.d(a,{default:function(){return g}});var l=t(6252),d=t(2262),o=t(3577),i=t(9963),r=t(3907),s=t(6583),n=t(6424);const u={class:"main"},m={class:"env-item-header"},p={class:"btn-box"};var c=(0,l.aZ)({__name:"EnvironmentView",setup(e){const a=(0,r.oR)(),t=(0,d.iH)(),c=(0,d.iH)(),_=(0,d.qj)({name:[{validator:s.ym,trigger:"blur",required:!0}],kyuubi_address:[{required:!0,trigger:"blur",message:"不能为空"}],address:[{required:!0,trigger:"blur",message:"不能为空"}]}),f=async()=>{await a.dispatch("environment/getEnvList")},g=()=>{t.value?.forEach(((e,t)=>{e.setVal(JSON.stringify(a.state.environment.envList[t].env_config||{},null,2))}))};(0,l.wF)((async()=>{await f(),g()}));const y=e=>{if(!t.value[e].getVal())throw a.commit("POP_MESSAGE",{message:"配置不能为空",type:"error"},{root:!0}),"Error"},w=e=>{e.isEdit=!0},v=e=>{e.isEdit=!1},k=(e,l,d)=>{(0,s.R2)([d[l]]).then((d=>{try{y(l),a.dispatch("environment/updateEnv",e).then((d=>{10007==d.data.code?(e.isEdit=!1,a.dispatch("environment/getEnvDetails",{id:e.id}).then((a=>{(a.data.code=1e3)&&(e=a.data.data,t.value[l].setVal(JSON.stringify(a.data.data?.env_config||{},null,2)))})),a.commit("POP_MESSAGE",{message:d.data.message,type:"success"},{root:!0})):a.commit("POP_MESSAGE",{message:d.data.message,type:"error"},{root:!0})})).catch((e=>{console.log("err",e)}))}catch(o){a.commit("POP_MESSAGE",{message:o,type:"error"})}})).catch((e=>{console.log(e)})),e.env_config=(0,s.iz)(t.value[l].getVal()||"{}")};return(e,r)=>{const s=(0,l.up)("el-input"),f=(0,l.up)("el-form-item"),g=(0,l.up)("el-form"),y=(0,l.up)("el-button"),b=(0,l.Q2)("permission");return(0,l.wg)(),(0,l.iD)("div",u,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,d.SU)(a).state.environment.envList,((e,a)=>((0,l.wg)(),(0,l.iD)("div",{key:a,class:"env-item-box"},[(0,l._)("p",m,(0,o.zw)(1==e.is_pro?"生产环境":"开发环境"),1),(0,l.Wm)(g,{model:e,ref_for:!0,ref_key:"ruleFormRef",ref:c,rules:_,disabled:!e.isEdit,"label-width":"auto",class:"env-item-form"},{default:(0,l.w5)((()=>[(0,l.Wm)(f,{label:"环境名",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:e.name,"onUpdate:modelValue":a=>e.name=a,style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(f,{label:"yarn地址",prop:"address"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:e.address,"onUpdate:modelValue":a=>e.address=a,style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(f,{label:"kyuubi地址",prop:"kyuubi_address"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:e.kyuubi_address,"onUpdate:modelValue":a=>e.kyuubi_address=a,style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(f,{label:"数据存储路径",prop:"storage_workdir"},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:e.storage_workdir,"onUpdate:modelValue":a=>e.storage_workdir=a,style:{width:"300px"}},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,l.Wm)(f,{label:"配置",prop:"env_config"},{default:(0,l.w5)((()=>[(0,l.Wm)(n.Z,{ref_for:!0,ref_key:"aceRef",ref:t,width:"80%",height:"250px",defaultLang:"ace/mode/json",disabled:!e.isEdit},null,8,["disabled"])])),_:2},1024),(0,l.Wm)(f,{label:"描述",style:{width:"80%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(s,{modelValue:e.description,"onUpdate:modelValue":a=>e.description=a,type:"textarea"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["model","rules","disabled"]),(0,l._)("div",p,[e.isEdit?((0,l.wg)(),(0,l.j4)(y,{key:0,type:"primary",onClick:t=>k(e,a,c.value)},{default:(0,l.w5)((()=>[(0,l.Uk)("更新")])),_:2},1032,["onClick"])):(0,l.kq)("",!0),e.isEdit?((0,l.wg)(),(0,l.j4)(y,{key:1,type:"primary",onClick:a=>v(e)},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:2},1032,["onClick"])):(0,l.wy)(((0,l.wg)(),(0,l.j4)(y,{key:2,type:"primary",onClick:(0,i.iM)((a=>w(e)),["stop"])},{default:(0,l.w5)((()=>[(0,l.Uk)("编辑")])),_:2},1032,["onClick"])),[[b,"update"]])])])))),128))])}}}),_=t(3744);const f=(0,_.Z)(c,[["__scopeId","data-v-223da1ae"]]);var g=f}}]);
//# sourceMappingURL=951.841cfbd7.js.map