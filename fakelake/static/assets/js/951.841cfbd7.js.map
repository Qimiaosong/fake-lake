{"version":3,"file":"assets/js/951.841cfbd7.js","mappings":"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","sources":["webpack://data-lake-analytics/./src/views/EnvironmentView.vue?a15c","webpack://data-lake-analytics/./src/views/EnvironmentView.vue"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, createBlock as _createBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers, resolveDirective as _resolveDirective, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-223da1ae\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = { class: \"main\" }\nconst _hoisted_2 = { class: \"env-item-header\" }\nconst _hoisted_3 = { class: \"btn-box\" }\n\nimport { ref, reactive, onBeforeMount} from 'vue'\nimport { useStore } from 'vuex'\nimport { FormInstance,FormRules } from 'element-plus'\nimport { submitForm,parseWithUndefinedHandling,checkName} from '../utils/common'\nimport Ace from '../components/common/Ace/Ace.vue'\n\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'EnvironmentView',\n  setup(__props) {\n\nconst store = useStore()\nconst aceRef = ref()\nconst ruleFormRef = ref()\n\n\nconst rules = reactive<FormRules>({\n    name:[{validator:checkName,trigger:'blur',required:true}],\n    kyuubi_address:[{required:true,trigger:'blur',message:'不能为空'}],\n    address:[{required:true,trigger:'blur',message:'不能为空'}]\n})\nconst getEnvList = async() => {\n    await store.dispatch(\"environment/getEnvList\")\n}\nconst initAceEle = () => {\n    aceRef.value?.forEach((aceItem:any,index:number) => {\n        aceItem.setVal(JSON.stringify(store.state.environment.envList[index].env_config || {},null,2))\n    });\n}\nonBeforeMount(async () => {\n    await getEnvList()\n    initAceEle()\n})\n\nconst validateForm = (index:number) => {\n    if(!aceRef.value[index].getVal()){\n        store.commit('POP_MESSAGE',{message: '配置不能为空', type: 'error'},{root:true})   \n        throw \"Error\"\n    }\n}\nconst toEdit = (envItem:any) => {\n    envItem.isEdit = true\n}\nconst toCancel = (envItem:any) => {\n    envItem.isEdit = false\n}\nconst toUpdate = (envItem:any,index:number,ruleFormRef:Array<FormInstance>) => {\n    //表单校验\n    submitForm([ruleFormRef[index]])\n    .then((res) => {\n        try{\n            //ace配置框校验\n            validateForm(index)\n            store.dispatch('environment/updateEnv',envItem)\n            .then((res) => {\n                if(res.data.code == 10007){\n                    envItem.isEdit = false\n                    store.dispatch('environment/getEnvDetails',{id:envItem.id}\n                    ).then((res:any) => {\n                        if(res.data.code = 1000){\n                            envItem = res.data.data\n                            aceRef.value[index].setVal(JSON.stringify(res.data.data?.env_config || {},null,2))\n                        }\n                    })\n                        store.commit('POP_MESSAGE',{message: res.data.message, type: 'success'},{root:true})\n                }else{\n                    store.commit('POP_MESSAGE',{message: res.data.message, type: 'error'},{root:true})\n                }\n            }).catch((err) => {\n                console.log('err',err)\n            })\n        }catch(err){\n            store.commit('POP_MESSAGE', { message: err, type: 'error' } )               \n        }\n    }).catch((e) => {\n        console.log(e)\n    })\n    envItem.env_config = parseWithUndefinedHandling(aceRef.value[index].getVal() || '{}')\n}\n\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_input = _resolveComponent(\"el-input\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _directive_permission = _resolveDirective(\"permission\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).state.environment.envList, (envItem, index) => {\n      return (_openBlock(), _createElementBlock(\"div\", {\n        key: index,\n        class: \"env-item-box\"\n      }, [\n        _createElementVNode(\"p\", _hoisted_2, _toDisplayString(envItem.is_pro == 1 ? '生产环境' :'开发环境'), 1),\n        _createVNode(_component_el_form, {\n          model: envItem,\n          ref_for: true,\n          ref_key: \"ruleFormRef\",\n          ref: ruleFormRef,\n          rules: rules,\n          disabled: !envItem.isEdit,\n          \"label-width\": \"auto\",\n          class: \"env-item-form\"\n        }, {\n          default: _withCtx(() => [\n            _createVNode(_component_el_form_item, {\n              label: \"环境名\",\n              prop: \"name\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_el_input, {\n                  modelValue: envItem.name,\n                  \"onUpdate:modelValue\": ($event: any) => ((envItem.name) = $event),\n                  style: {\"width\":\"300px\"}\n                }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n              ]),\n              _: 2\n            }, 1024),\n            _createVNode(_component_el_form_item, {\n              label: \"yarn地址\",\n              prop: \"address\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_el_input, {\n                  modelValue: envItem.address,\n                  \"onUpdate:modelValue\": ($event: any) => ((envItem.address) = $event),\n                  style: {\"width\":\"300px\"}\n                }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n              ]),\n              _: 2\n            }, 1024),\n            _createVNode(_component_el_form_item, {\n              label: \"kyuubi地址\",\n              prop: \"kyuubi_address\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_el_input, {\n                  modelValue: envItem.kyuubi_address,\n                  \"onUpdate:modelValue\": ($event: any) => ((envItem.kyuubi_address) = $event),\n                  style: {\"width\":\"300px\"}\n                }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n              ]),\n              _: 2\n            }, 1024),\n            _createVNode(_component_el_form_item, {\n              label: \"数据存储路径\",\n              prop: \"storage_workdir\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_el_input, {\n                  modelValue: envItem.storage_workdir,\n                  \"onUpdate:modelValue\": ($event: any) => ((envItem.storage_workdir) = $event),\n                  style: {\"width\":\"300px\"}\n                }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n              ]),\n              _: 2\n            }, 1024),\n            _createVNode(_component_el_form_item, {\n              label: \"配置\",\n              prop: \"env_config\"\n            }, {\n              default: _withCtx(() => [\n                _createVNode(Ace, {\n                  ref_for: true,\n                  ref_key: \"aceRef\",\n                  ref: aceRef,\n                  width: '80%',\n                  height: '250px',\n                  defaultLang: 'ace/mode/json',\n                  disabled: !envItem.isEdit\n                }, null, 8, [\"disabled\"])\n              ]),\n              _: 2\n            }, 1024),\n            _createVNode(_component_el_form_item, {\n              label: \"描述\",\n              style: {\"width\":\"80%\"}\n            }, {\n              default: _withCtx(() => [\n                _createVNode(_component_el_input, {\n                  modelValue: envItem.description,\n                  \"onUpdate:modelValue\": ($event: any) => ((envItem.description) = $event),\n                  type: \"textarea\"\n                }, null, 8, [\"modelValue\", \"onUpdate:modelValue\"])\n              ]),\n              _: 2\n            }, 1024)\n          ]),\n          _: 2\n        }, 1032, [\"model\", \"rules\", \"disabled\"]),\n        _createElementVNode(\"div\", _hoisted_3, [\n          (envItem.isEdit)\n            ? (_openBlock(), _createBlock(_component_el_button, {\n                key: 0,\n                type: \"primary\",\n                onClick: ($event: any) => (toUpdate(envItem,index,ruleFormRef.value))\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"更新\")\n                ]),\n                _: 2\n              }, 1032, [\"onClick\"]))\n            : _createCommentVNode(\"\", true),\n          (envItem.isEdit)\n            ? (_openBlock(), _createBlock(_component_el_button, {\n                key: 1,\n                type: \"primary\",\n                onClick: ($event: any) => (toCancel(envItem))\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"取消\")\n                ]),\n                _: 2\n              }, 1032, [\"onClick\"]))\n            : _withDirectives((_openBlock(), _createBlock(_component_el_button, {\n                key: 2,\n                type: \"primary\",\n                onClick: _withModifiers(($event: any) => (toEdit(envItem)), [\"stop\"])\n              }, {\n                default: _withCtx(() => [\n                  _createTextVNode(\"编辑\")\n                ]),\n                _: 2\n              }, 1032, [\"onClick\"])), [\n                [_directive_permission, 'update']\n              ])\n        ])\n      ]))\n    }), 128))\n  ]))\n}\n}\n\n})","import script from \"./EnvironmentView.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./EnvironmentView.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./EnvironmentView.vue?vue&type=style&index=0&id=223da1ae&scoped=true&lang=scss\"\n\nimport exportComponent from \"/Users/songwen/lakesoul-dashboard/frontend/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-223da1ae\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_defineComponent","__name","setup","__props","store","useStore","aceRef","ref","ruleFormRef","rules","reactive","name","validator","checkName","trigger","required","kyuubi_address","message","address","getEnvList","async","dispatch","initAceEle","value","forEach","aceItem","index","setVal","JSON","stringify","state","environment","envList","env_config","onBeforeMount","validateForm","getVal","commit","type","root","toEdit","envItem","isEdit","toCancel","toUpdate","submitForm","then","res","data","code","id","catch","err","console","log","e","parseWithUndefinedHandling","_ctx","_cache","_component_el_input","_resolveComponent","_component_el_form_item","_component_el_form","_component_el_button","_directive_permission","_resolveDirective","_openBlock","_createElementBlock","_Fragment","_renderList","_unref","key","_createElementVNode","_toDisplayString","is_pro","_createVNode","model","ref_for","ref_key","disabled","default","_withCtx","label","prop","modelValue","$event","style","_","storage_workdir","Ace","width","height","defaultLang","description","_createBlock","onClick","_createTextVNode","_createCommentVNode","_withDirectives","_withModifiers","__exports__"],"sourceRoot":""}